var z=Object.defineProperty;var g=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var w=(i,t,n)=>t in i?z(i,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[t]=n,_=(i,t)=>{for(var n in t||(t={}))E.call(t,n)&&w(i,n,t[n]);if(g)for(var n of g(t))S.call(t,n)&&w(i,n,t[n]);return i};import{a as k,d as h,S as C}from"./index.29c6ae5a.js";import{g as x,m as N,o as f,c as d,u as p,q as j,d as v,s as D,G as B,w as $,a as F,F as G,b as T,j as V,H}from"./vendor.ce457e9e.js";var I=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},O={exports:{}};(function(i,t){(function(n,s){i.exports=s()})(I,function(){const n=(e,o,r,a)=>{const c=(o*r+2*e)/r**3,m=-(2*o*r+3*e)/r**2,b=o,P=e;return c*a**3+m*a**2+b*a+P},s=(e,o,r,a)=>{const c=(o*r+2*e)/r**3,m=-(2*o*r+3*e)/r**2,b=o;return 3*c*a**2+2*m*a+b},u=function(e,o){Object.entries(typeof e=="number"?{value:e}:e).map(([a,c])=>o(c,a))};function l(e,o){this.start=new Date/1e3,this.time=o,this.from=e,this.current=e,this.to=e,this.speed=0}l.prototype.get=function(e){const o=e/1e3-this.start;if(o<0)throw new Error("Cannot read in the past");return o>=this.time?this.to:this.to-n(this.to-this.from,this.speed,this.time,o)},l.prototype.getSpeed=function(e){const o=e/1e3-this.start;return o>=this.time?0:s(this.to-this.from,this.speed,this.time,o)},l.prototype.set=function(e,o){const r=new Date,a=this.get(r);return this.speed=this.getSpeed(r),this.start=r/1e3,this.from=a,this.to=e,o&&(this.time=o),a};function y(e,o=300){return typeof e=="number"&&(e={value:e}),u(e,(r,a)=>{const c=new l(r,o/1e3);Object.defineProperty(e,"_"+a,{value:c}),Object.defineProperty(e,"$"+a,{get:()=>c.to}),Object.defineProperty(e,a,{get:()=>c.get(new Date),set:m=>c.set(m),enumerable:!0})}),Object.defineProperty(e,"get",{get:()=>function(r="value",a=new Date){return this["_"+r].get(a)}}),Object.defineProperty(e,"set",{get:()=>function(r,a=0){u(r,(c,m)=>{this["_"+m].set(c,a/1e3)})}}),e}return y})})(O);var L=O.exports;const M={props:{pub:String,pulse:Number,x:Number,y:Number},emits:["remove"],setup(i,{emit:t}){const n=i,s=L({x:n.x,y:n.y,pulse:n.pulse},1e3),u=x({x:s.x,y:s.y,size:Date.now()-s.pulse});return N(()=>{s.set({x:n.x,y:n.y})}),setInterval(()=>{(s.x!=n.x||s.y!=n.y)&&(u.x=s.x,u.y=s.y),s.pulse=n.pulse,u.size=(150/(Date.now()/1e4-s.pulse/1e4)).toFixed(),u.size<30&&t("remove")},10),(l,y)=>(f(),d("div",{class:"m-1 flex absolute pointer-events-none opacity-80",style:j({transform:"translate(-50%,-50%)",left:p(u).x*100+"%",top:p(u).y*100+"%"})},[p(u).size>100?(f(),d("div",{key:0,class:"w-40px transition-all duration-100 ease",style:j({transform:`scale(${p(u).size/500})`})},[v(p(k),{class:"rounded-full w-32px h-32px",pub:i.pub,size:100},null,8,["pub"])],4)):D("",!0)],4))}};function q(){const i=x({count:0,max:10,list:{}});h.get("playersCount").on(s=>i.count=s),h.get("players").map().on((s,u)=>{s!=null&&(i.list[u]=_({},s))});const t=x({pair:null,num:null,pub:null,x:0,y:0});async function n(){t.pair=await C.pair(),t.pub=t.pair.pub,t.num=i.count%i.max;const s=h.get("players").get(t.num);document.addEventListener("mousemove",l=>{t.x=l.clientX/document.documentElement.clientWidth,t.y=l.clientY/document.documentElement.clientHeight,s.put({x:t.x,y:t.y})}),setInterval(()=>{s.get("pulse").put(Date.now())},500);let u={pub:t.pub,pulse:Date.now(),x:Math.random(),y:Math.random()};s.put(u),h.get("playersCount").put(t.num+1)}return{players:i,me:t,join:n}}const A={class:"flex flex-col p-4"},J=F("div",{class:"font-bold"},"Players online",-1),Y={setup(i){const{players:t,me:n,join:s}=q();return(u,l)=>{const y=M;return f(),d("div",A,[J,p(n).pub?D("",!0):(f(),d("button",{key:0,class:"hover:shadow-xl m-2 p-4 shadow-md transition-all duration-400 ease",onClick:l[0]||(l[0]=e=>p(s)())},"Join")),(f(),d("div",{class:"flex flex-col",key:p(t).count},[v(B,{name:"fade"},{default:$(()=>[(f(!0),d(G,null,T(p(t).list,(e,o)=>(f(),V(y,H({key:e.pub},e),null,16))),128))]),_:1})]))])}}};export{Y as default};
