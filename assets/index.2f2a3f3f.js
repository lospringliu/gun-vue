var H=Object.defineProperty;var j=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var P=(r,t,n)=>t in r?H(r,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[t]=n,k=(r,t)=>{for(var n in t||(t={}))N.call(t,n)&&P(r,n,t[n]);if(j)for(var n of j(t))V.call(t,n)&&P(r,n,t[n]);return r};import{_ as B,d as _,s as U}from"./index.49f7eb21.js";import{z as F,C as O,o as f,c as b,D as w,E,i as C,u as h,d as $,G as W,w as q,a as Z,F as J,b as K,g as Q,H as X}from"./vendor.344a7b7f.js";(()=>{if(!n())return;const r=CanvasRenderingContext2D.prototype,t=r.drawImage;if(!t){console.error("This script requires a basic implementation of drawImage");return}r.drawImage=function(e,a,i){if(!(arguments.length===9))return t.apply(this,[...arguments]);const d=s(...arguments);if(!l(d))return t.apply(this,d)};function n(){const c=document.createElement("canvas").getContext("2d");c.fillRect(0,0,40,40),c.drawImage(c.canvas,-40,-40,80,80,50,50,20,20);const e=c.getImageData(50,50,30,30),a=new Uint32Array(e.data.buffer),i=(p,m)=>a[m*e.width+p],u=[[9,9],[20,9],[9,20],[20,20]],d=[[10,10],[19,10],[10,19],[19,19]];return u.some(([p,m])=>i(p,m)!==0)||d.some(([p,m])=>i(p,m)===0)}function s(c,e,a,i,u,d,p,m,g){const{width:L,height:G}=o(c);i<0&&(e+=i,i=Math.abs(i)),u<0&&(a+=u,u=Math.abs(u)),m<0&&(d+=m,m=Math.abs(m)),g<0&&(p+=g,g=Math.abs(g));const v=Math.max(e,0),A=Math.min(e+i,L),x=Math.max(a,0),D=Math.min(a+u,G),M=m/i,S=g/u;return[c,v,x,A-v,D-x,e<0?d-e*M:d,a<0?p-a*S:p,(A-v)*M,(D-x)*S]}function l(c){return[3,4,7,8].some(e=>!c[e])}function o(c){const e=a=>{const i=globalThis[a];return i&&c instanceof i};if(e("HTMLImageElement"))return{width:c.naturalWidth,height:c.naturalHeight};if(e("HTMLVideoElement"))return{width:c.videoWidth,height:c.videoHeight};if(e("SVGImageElement"))throw new TypeError("SVGImageElement isn't yet supported as source image.","UnsupportedError");if(e("HTMLCanvasElement")||e("ImageBitmap"))return c}})();const y={};if(document){class r extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"}),this.img=document.createElement("img"),this.shadowRoot.append(this.img)}render(){this.pub=this.hasAttribute("pub")?this.getAttribute("pub"):"1234123455Ute2tFhdjDQgzR-1234lfSlZxgEZKuquI.2F-j1234434U1234Asj-5lxnECG5TDyuPD8gEiuI123",this.size=this.hasAttribute("size")?this.getAttribute("size"):400,this.round=!!(this.hasAttribute("round")||this.getAttribute("round")==""),this.round?this.img.style.borderRadius="100%":this.img.style.borderRadius="0%",this.dark=!!(this.hasAttribute("dark")||this.getAttribute("dark")==""),this.img.src=I(this.pub,this.size,this.dark)}connectedCallback(){this.render()}static get observedAttributes(){return["pub","round","size","dark"]}attributeChangedCallback(n,s,l){this.render()}}customElements.define("gun-avatar",r),document.addEventListener("DOMContentLoaded",()=>{let t=document.getElementsByClassName("gun-avatar");for(let n of t)n.src=I(n.dataset.pub,n.dataset.size,n.dataset.dark)})}function I(r,t=800,n=!1){var s;if(!r)return;if((s=y==null?void 0:y[t])==null?void 0:s[r])return y[t][r];const l=document.createElement("canvas");l.width=l.height=t;const o=l.getContext("2d"),e=r.split(".").map(a=>z(a));return Y(o,e[0][42],e[1][42],t,n),R(e[0],o,t,.42*t),o.globalCompositeOperation="lighter",R(e[1],o,t,.125*t),o.globalCompositeOperation="source-over",o.scale(-1,1),o.translate(-t/2,0),o.drawImage(l,t/2,0,t,t,0,0,t,t),y[t]=y[t]||{},y[t][r]=l.toDataURL(),y[t][r]}function Y(r,t,n,s,l=!1){var o=r.createLinearGradient(0,0,0,s);let c=70;l&&(c=0),o.addColorStop(0,`hsl(0,0%,${c+t*30}%)`),o.addColorStop(1,`hsl(0,0%,${c+n*30}%)`),r.fillStyle=o,r.fillRect(0,0,s,s)}function R(r,t,n,s){tt(r,7).forEach(o=>{if(o.length==7){let c=n/2+o[0]*n/2,e=o[1]*n,a=o[2]*s,i=o[3]*360,u=o[4]*100,d=o[5]*100,p=o[6];t.beginPath(),t.arc(c,e,a,0,2*Math.PI,!1),t.fillStyle=`hsla(${i},${u}%,${d}%,${p})`,t.closePath(),t.fill()}})}function z(r){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split("");let s=[],l=0;for(let o of r)s[l++]=n.indexOf(o)/64;return s}function tt(r,t=3){return[...Array(Math.ceil(r.length/t))].map(()=>r.splice(0,t))}const et=["title"],nt={props:{pub:String,size:{type:Number,default:40}},setup(r){const t=r,n=F("");return O(()=>{t.pub&&t.pub.includes(".")&&t.size>=10&&(n.value=I(t.pub,32))}),(s,l)=>r.pub?(f(),b("div",{key:0,class:"avatar bg-local",title:r.pub,style:w({background:`url(${n.value})`})},null,12,et)):E("",!0)}};var rt=B(nt,[["__scopeId","data-v-25e8f77e"]]),st=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},T={exports:{}};(function(r,t){(function(n,s){r.exports=s()})(st,function(){const n=(e,a,i,u)=>{const d=(a*i+2*e)/i**3,p=-(2*a*i+3*e)/i**2,m=a,g=e;return d*u**3+p*u**2+m*u+g},s=(e,a,i,u)=>{const d=(a*i+2*e)/i**3,p=-(2*a*i+3*e)/i**2,m=a;return 3*d*u**2+2*p*u+m},l=function(e,a){Object.entries(typeof e=="number"?{value:e}:e).map(([u,d])=>a(d,u))};function o(e,a){this.start=new Date/1e3,this.time=a,this.from=e,this.current=e,this.to=e,this.speed=0}o.prototype.get=function(e){const a=e/1e3-this.start;if(a<0)throw new Error("Cannot read in the past");return a>=this.time?this.to:this.to-n(this.to-this.from,this.speed,this.time,a)},o.prototype.getSpeed=function(e){const a=e/1e3-this.start;return a>=this.time?0:s(this.to-this.from,this.speed,this.time,a)},o.prototype.set=function(e,a){const i=new Date,u=this.get(i);return this.speed=this.getSpeed(i),this.start=i/1e3,this.from=u,this.to=e,a&&(this.time=a),u};function c(e,a=300){return typeof e=="number"&&(e={value:e}),l(e,(i,u)=>{const d=new o(i,a/1e3);Object.defineProperty(e,"_"+u,{value:d}),Object.defineProperty(e,"$"+u,{get:()=>d.to}),Object.defineProperty(e,u,{get:()=>d.get(new Date),set:p=>d.set(p),enumerable:!0})}),Object.defineProperty(e,"get",{get:()=>function(i="value",u=new Date){return this["_"+i].get(u)}}),Object.defineProperty(e,"set",{get:()=>function(i,u=0){l(i,(d,p)=>{this["_"+p].set(d,u/1e3)})}}),e}return c})})(T);var at=T.exports;const ot={props:{pub:String,pulse:Number,x:Number,y:Number},emits:["remove"],setup(r,{emit:t}){const n=r,s=at({x:n.x,y:n.y,pulse:n.pulse},1e3),l=C({x:s.x,y:s.y,size:Date.now()-s.pulse});return O(()=>{s.set({x:n.x,y:n.y})}),setInterval(()=>{(s.x!=n.x||s.y!=n.y)&&(l.x=s.x,l.y=s.y),s.pulse=n.pulse,l.size=(150/(Date.now()/1e4-s.pulse/1e4)).toFixed(),l.size<30&&t("remove")},10),(o,c)=>(f(),b("div",{class:"m-1 flex absolute pointer-events-none opacity-80",style:w({transform:"translate(-50%,-50%)",left:h(l).x*100+"%",top:h(l).y*100+"%"})},[h(l).size>100?(f(),b("div",{key:0,class:"w-40px transition-all duration-100 ease",style:w({transform:`scale(${h(l).size/500})`})},[$(rt,{class:"rounded-full",pub:r.pub,size:100},null,8,["pub"])],4)):E("",!0)],4))}};function it(){const r=C({count:0,max:10,list:{}});_.get("playersCount").on(s=>r.count=s),_.get("players").map().on((s,l)=>{s!=null&&(r.list[l]=k({},s))});const t=C({pair:null,num:null,pub:null,x:0,y:0});async function n(){t.pair=await U.pair(),t.pub=t.pair.pub,t.num=r.count%r.max;const s=_.get("players").get(t.num);document.addEventListener("mousemove",o=>{t.x=o.clientX/document.documentElement.clientWidth,t.y=o.clientY/document.documentElement.clientHeight,s.put({x:t.x,y:t.y})}),setInterval(()=>{s.get("pulse").put(Date.now())},500);let l={pub:t.pub,pulse:Date.now(),x:Math.random(),y:Math.random()};s.put(l),_.get("playersCount").put(t.num+1)}return{players:r,me:t,join:n}}const lt={class:"flex flex-col p-4"},ut=Z("div",{class:"font-bold"},"Players online",-1),mt={setup(r){const{players:t,me:n,join:s}=it();return(l,o)=>{const c=ot;return f(),b("div",lt,[ut,h(n).pub?E("",!0):(f(),b("button",{key:0,class:"hover:shadow-xl m-2 p-4 shadow-md transition-all duration-400 ease",onClick:o[0]||(o[0]=e=>h(s)())},"Join")),(f(),b("div",{class:"flex flex-col",key:h(t).count},[$(W,{name:"fade"},{default:q(()=>[(f(!0),b(J,null,K(h(t).list,(e,a)=>(f(),Q(c,X({key:e.pub},e),null,16))),128))]),_:1})]))])}}};export{mt as default};
